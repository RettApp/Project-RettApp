var currentFeature_or_Features=null;var watchID=null;var map,GeoMarker,activePage,geolocpoint;if(localStorage.getItem("settings")===null){var settings={};settings.startdisclaimer="0";settings.meddisclaimer="0";settings.position="0";settings.zoomrange="10";settings.poison="112";settings.rescuecoordinationcenter="112";localStorage.setItem("settings",JSON.stringify(settings))}if(localStorage.getItem("visiblemeddisclaimer")===null){localStorage.setItem("visiblemeddisclaimer","0")}function initPositionMap(){var c=JSON.parse(localStorage.getItem("settings"));var d=+c.zoomrange;var a={zoom:d,center:new google.maps.LatLng(-34.397,150.644),mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},zoomControl:false,};map=new google.maps.Map(document.getElementById("location-01-index-map_canvas"),a);GeoMarker=new GeolocationMarker();GeoMarker.setCircleOptions({fillColor:"#808080"});var b=navigator.geolocation.watchPosition(function(e){geolocpoint=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);map.setCenter(geolocpoint);map.setZoom(d)},function(e){console.log(typeof e=="string"?e:"error")},{maximumAge:4000,enableHighAccuracy:true});google.maps.event.addListenerOnce(GeoMarker,"position_changed",function(){map.setCenter(this.getPosition());map.fitBounds(this.getBounds());map.setZoom(d)});GeoMarker.setMap(map);showGeoJSON(geojson_leitstellen)}function panelAndListRefresh(){$('body > [data-role="panel"]').panel();$('body > [data-role="panel"] [data-role="listview"]').listview().listview("refresh");$('body > [data-role="page"] [data-role="listview"]').listview().listview("refresh")}function refreshSlider(a){$(a).slider().slider("refresh")}function refreshSelectMenu(a){$(a).selectmenu().selectmenu("refresh")}function changeSliderOnSettings(a,b){$(a+' [value="'+b+'"]').prop("selected",true);$(a).slider().slider("refresh")}function changeSelectMenuOnSettings(a,b){$(a+' [value="'+b+'"]').prop("selected",true);$(a).selectmenu().selectmenu("refresh")}function changeSliderVisibleOnSettings(a,b){$(a).slider(b);$(a).slider("refresh")}function changeSelectMenuVisibleOnSettings(a,b){$(a).selectmenu(b);$(a).selectmenu("refresh")}function openDeviceBrowser(a){window.open(a,"_system","location=no")}function showGeoJSON(b,d){currentFeature_or_Features=new GeoJSON(b,d||null);if(currentFeature_or_Features.type&&currentFeature_or_Features.type=="Error"){document.getElementById("putsomthing").value=currentFeature_or_Features.message;return}if(currentFeature_or_Features.length){for(var c=0;c<currentFeature_or_Features.length;c++){if(currentFeature_or_Features[c].length){for(var a=0;a<currentFeature_or_Features[c].length;a++){currentFeature_or_Features[c][a].setMap(map);if(currentFeature_or_Features[c][a].geojsonProperties){setInfoWindow(currentFeature_or_Features[c][a])}}}else{currentFeature_or_Features[c].setMap(map)}if(currentFeature_or_Features[c].geojsonProperties){setInfoWindow(currentFeature_or_Features[c])}}}else{currentFeature_or_Features.setMap(map);if(currentFeature_or_Features.geojsonProperties){setInfoWindow(currentFeature_or_Features)}}}function setInfoWindow(a){google.maps.event.addListener(a,"click",function(d){var c="<b>Aktuelle Leitstelle:</b>";for(var b in this.geojsonProperties){if(b!="Telefon"){c+="<br />"+b+": "+this.geojsonProperties[b]}}c+='<p><a href="tel:'+this.geojsonProperties.Telefon+'" class="ui-btn ui-icon-phone ui-btn-icon-left ui-corner-all">Diese Anrufen</a></p>';$("#location-01-map_canvas_info").html(c)})}$(document).on("pagebeforeshow",function(a){panelAndListRefresh()});$(document).on("pageshow","#location-01-index",function(){var a=JSON.parse(localStorage.getItem("settings"));if(a.position=="0"){initPositionMap()}else{$("#location-01-index-map_canvas").html("<p>Die Funktion ist deaktiviert.</p>")}});$(document).on("pagebeforeshow","#function-02-settings",function(b){var a=JSON.parse(localStorage.getItem("settings"));if(localStorage.getItem("visiblemeddisclaimer")=="0"){changeSliderVisibleOnSettings("#settings-meddisclaimer","disable")}else{changeSliderVisibleOnSettings("#settings-meddisclaimer","enable")}if(a.position=="1"){changeSelectMenuVisibleOnSettings("#settings-zoomrange","disable")}else{changeSelectMenuVisibleOnSettings("#settings-zoomrange","enable")}changeSliderOnSettings("#settings-startdisclaimer",a.startdisclaimer);changeSliderOnSettings("#settings-meddisclaimer",a.meddisclaimer);changeSliderOnSettings("#settings-position",a.position);changeSelectMenuOnSettings("#settings-zoomrange",a.zoomrange);changeSelectMenuOnSettings("#settings-poison",a.poison);changeSelectMenuOnSettings("#settings-rescuecoordinationcenter",a.rescuecoordinationcenter)});$(document).on("pagebeforeshow","#main-01-disclaimer",function(b){var a=JSON.parse(localStorage.getItem("settings"));if(a.startdisclaimer=="1"){$.mobile.changePage("#main-02-index")}});$(document).on("pagebeforeshow","#drugs-01-disclaimer",function(b){var a=JSON.parse(localStorage.getItem("settings"));if(a.meddisclaimer=="1"){$.mobile.changePage("#drugs-02-index")}});$(document).on("pagebeforeshow",function(a){activePage=$.mobile.activePage.attr("id");$("a.ui-btn-active").removeClass("ui-btn-active");$('[href="#'+activePage+'"]').addClass("ui-btn-active")});$(document).on("pageshow",function(b){var a=JSON.parse(localStorage.getItem("settings"));$(".getPoisonNumber").attr("href","tel:"+a.poison);$(".getRescueCoordinationCenterNumber").attr("href","tel:"+a.rescuecoordinationcenter)});$(document).on("pageshow",function(a){$("#saveSettings").click(function(){var b={};b.startdisclaimer=$("#settings-startdisclaimer").val();b.meddisclaimer=$("#settings-meddisclaimer").val();b.position=$("#settings-position").val();b.zoomrange=$("#settings-zoomrange").val();b.poison=$("#settings-poison").val();b.rescuecoordinationcenter=$("#settings-rescuecoordinationcenter").val();localStorage.setItem("settings",JSON.stringify(b));location.reload(true)});$("#setVisibleMedSetting").click(function(){if(localStorage.getItem("visiblemeddisclaimer")=="0"){localStorage.setItem("visiblemeddisclaimer","1")}})});$(document).on("click",".show-page-loading-msg",function(){var d=$(this),c=d.jqmData("theme")||$.mobile.loader.prototype.options.theme,a=d.jqmData("msgtext")||$.mobile.loader.prototype.options.text,b=d.jqmData("textvisible")||$.mobile.loader.prototype.options.textVisible,e=!!d.jqmData("textonly");html=d.jqmData("html")||"";$.mobile.loading("show",{text:a,textVisible:b,theme:c,textonly:e,html:html})}).on("click",".hide-page-loading-msg",function(){$.mobile.loading("hide")});